<!doctype html>
<html lang="en"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Stadium Design Showcase — Digital Book</title>
<style>
  :root{
    --bg:#e9f2f9;         /* lighter blue backdrop */
    --brand:#1e6aa8;      /* MPDC-ish blue (lighter) */
    --brand-ink:#0c2d45;  /* dark ink */
    --accent:#c8a86b;     /* gold accent */
    --page:#ffffff;
    --muted:#5a6b78;
    --border:#e4ecf3;
  }
  html,body{margin:0;height:100%;font-family:Arial,Helvetica,sans-serif;color:var(--brand-ink)}
  body{background:linear-gradient(180deg,var(--bg) 0,#f2f6fa 280px,#f7fafc 280px)}

  /* Header / Nav */
  header{
    position:sticky; top:0; z-index:1000;
    background:linear-gradient(180deg,#ffffff 0,#f6fbff 100%);
    border-bottom:1px solid var(--border);
    box-shadow:0 2px 12px rgba(0,0,0,.06);
  }
  .head-inner{
    max-width:1200px; margin:0 auto; padding:10px 14px;
    display:flex; align-items:center; gap:14px;
  }
  .brand-wrap{display:flex; align-items:center; gap:12px}
  .brand-wrap img{height:36px; width:auto; border-radius:4px}
  .brand-title{font-weight:700; letter-spacing:.3px; color:var(--brand-ink); cursor:pointer}
  .brand-title:active{opacity:.85}
  .spacer{flex:1}
  .nav{ display:flex; gap:10px; align-items:center; }
  .nav > .menu{ position:relative; }
  .menu > button, .menu > a{
    appearance:none; border:1px solid var(--border);
    background:#fff; color:#1f2d36;
    border-radius:10px; padding:10px 14px; cursor:pointer;
    font-weight:600;
    box-shadow:0 1px 4px rgba(0,0,0,.04);
    touch-action:manipulation;
  }
  .menu > button:hover, .menu > a:hover{border-color:#d8e5ef}
  .dropdown{
    position:absolute; top:44px; left:0;
    background:#fff; border:1px solid var(--border);
    border-radius:12px; box-shadow:0 10px 26px rgba(0,0,0,.12);
    min-width:260px; max-width:92vw; display:none; max-height:60vh; overflow:auto;
  }
  .menu.open .dropdown{display:block}
  .dropdown h4{
    margin:10px 12px 6px; font-size:13px; color:#486072; text-transform:uppercase; letter-spacing:.6px;
  }
  .dropdown a{
    display:block; padding:10px 12px; text-decoration:none; color:#1f2d36; border-radius:8px; margin:4px 8px;
  }
  .dropdown a:hover{background:#f2f7fb}

  .wrap{max-width:1200px; margin:0 auto; padding:16px}
  .book{
    background:var(--page); border-radius:14px;
    box-shadow:0 14px 34px rgba(16,40,60,.12);
    min-height:calc(100vh - 300px);
    position:relative; overflow:hidden; border:1px solid var(--border);
  }
  .toolbar{
    display:flex; gap:10px; align-items:center; padding:12px;
    border-bottom:1px solid var(--border); background:#ffffffc7; backdrop-filter:saturate(1.2) blur(3px);
  }
  .toolbar .title{font-weight:800; letter-spacing:.2px; cursor:pointer}
  .toolbar .title:active{opacity:.85}
  .toolbar .pill{
    background:#eef5fb; color:#2d3a44; padding:6px 10px; border-radius:999px; font-size:12px;
  }
  .paper{min-height:calc(100vh - 300px - 56px); display:grid; place-items:center; background:#fff}
  .page{max-width:1000px; width:100%; padding:18px}
  .inner{border:1px solid var(--border); border-radius:12px; padding:20px}
  .inner.cover{
    background:
      radial-gradient(900px 400px at 70% 10%, rgba(200,168,107,.14), rgba(255,255,255,0)),
      linear-gradient(180deg,#ffffff 0,#fbfdff 100%);
    text-align:center; padding:48px 22px;
  }
  .cover .kicker{
    display:inline-block; background:#eef5fb; color:#1e6aa8;
    padding:6px 10px; border-radius:999px; font-weight:700; margin-bottom:12px; letter-spacing:.3px;
  }
  h1{margin:8px 0 6px; font-size:36px}
  .sub{color:#5a6b78; font-size:16px}
  figure{margin:0} figure img{width:100%; height:auto; border-radius:10px}
  figcaption{margin-top:8px; color:#2d3a44; font-size:14px}
  iframe{width:100%; aspect-ratio:16/9; border:0; border-radius:10px;}
  .navbtn{
    position:absolute; top:50%; transform:translateY(-50%);
    background:#fff; border:1px solid var(--border); border-radius:10px;
    padding:12px 14px; cursor:pointer; font-weight:700;
    box-shadow:0 6px 16px rgba(0,0,0,.08); touch-action:manipulation;
  }
  #prev{left:12px} #next{right:12px}
  .hint{font-size:12px; color:#6a7b88; margin-top:6px}
  footer{color:#6f8aa0; padding:18px; text-align:center}

  /* Plans grid & lightbox */
  .plans-head{margin:0 0 8px; font-size:22px}
  .plans-sub{margin:0 0 14px; color:#5a6b78}
  .plans-grid{display:grid; grid-template-columns:repeat(2,1fr); gap:12px}
  @media(min-width:900px){ .plans-grid{grid-template-columns:repeat(4,1fr);} }
  @media(max-width:520px){ .plans-grid{grid-template-columns:1fr;} }
  .thumb{border:1px solid var(--border); border-radius:10px; overflow:hidden; cursor:pointer; background:#fff}
  .thumb img{width:100%; height:auto; display:block}
  .thumb span{display:block; padding:6px 8px; font-size:12px; color:#2b3a46;}
  .plans-pager{display:flex; align-items:center; gap:8px; margin-top:14px; flex-wrap:wrap}
  .btn-min{appearance:none; border:1px solid var(--border); background:#fff; padding:10px 12px; border-radius:8px; cursor:pointer; touch-action:manipulation}
  .min-muted{font-size:12px; color:#6b7c8a}

  .lightbox{
    position:fixed; inset:0; background:rgba(10,20,30,.85);
    display:none; align-items:center; justify-content:center; z-index:2000;
  }
  .lightbox.open{display:flex}
  .lb-inner{max-width:92vw; max-height:88vh; position:relative}
  .lb-inner img{max-width:92vw; max-height:88vh; border-radius:10px; display:block}
  .lb-prev,.lb-next,.lb-close{
    position:absolute; top:50%; transform:translateY(-50%); background:#fff; border:1px solid var(--border);
    border-radius:10px; padding:10px 12px; cursor:pointer; font-weight:700; box-shadow:0 6px 16px rgba(0,0,0,.25);
    touch-action:manipulation;
  }
  .lb-prev{left:-4rem} .lb-next{right:-4rem}
  .lb-close{top:-3rem; right:0; transform:none}
  @media(max-width:900px){ .lb-prev{left:0.5rem} .lb-next{right:0.5rem} .lb-close{right:0.5rem} }

  /* Mobile tuning */
  @media (max-width:860px){
    .dropdown{right:0; left:auto; width:min(92vw, 360px)}
    .nav{gap:8px}
    .menu > button, .menu > a{padding:10px 12px}
    .navbtn{padding:10px 12px}
    h1{font-size:30px}
  }
  @media (max-width:520px){
    .head-inner{gap:10px}
    .brand-title{font-size:14px}
    .toolbar{padding:10px}
    .page{padding:14px}
    .navbtn{top:auto; bottom:10px; transform:none}
    #prev{left:10px} #next{right:10px}
  }
</style>
</head>
<body>
<header>
  <div class="head-inner">
    <div class="brand-wrap">
      <img src="assets/mpdc-logo.png" alt="MPDC" onerror="this.style.display='none'">
      <div class="brand-title" id="homeBrand">Macquarie Point Development Corporation</div>
    </div>
    <div class="spacer"></div>
    <nav class="nav">
      <div class="menu" id="menuBoards">
        <button type="button">Display Boards ▾</button>
        <div class="dropdown" id="ddBoards">
          <h4>Display Boards</h4>
          <div id="boardsList"></div>
        </div>
      </div>
      <div class="menu" id="menuVideos">
        <button type="button">Videos ▾</button>
        <div class="dropdown" id="ddVideos">
          <h4>Videos</h4>
          <div id="videosList"></div>
        </div>
      </div>
      <div class="menu" id="menuPlans">
        <button type="button">Plans ▾</button>
        <div class="dropdown" id="ddPlans">
          <h4>Plans</h4>
          <div id="plansList"></div>
        </div>
      </div>
      <div class="menu"><a href="#" id="jumpLinks">Links</a></div>
    </nav>
  </div>
</header>

<div class="wrap">
  <div class="book">
    <div class="toolbar">
      <div class="title" id="homeTitle">Stadium Design Showcase — Digital Book</div>
      <div class="spacer"></div>
      <span class="pill" id="ind">Page 1 / 1</span>
    </div>
    <div class="paper">
      <div class="page">
        <div class="inner cover" id="inner">
          <div class="kicker">Macquarie Point Development Corporation</div>
          <h1>STADIUM DESIGN SHOWCASE</h1>
          <div class="sub">31 Oct – 5 Nov · The Goods Shed, Hobart</div>
          <div class="hint" style="margin-top:14px">Detecting Display Boards…</div>
        </div>
      </div>
      <button class="navbtn" id="prev" aria-label="Previous page">‹ Prev</button>
      <button class="navbtn" id="next" aria-label="Next page">Next ›</button>
    </div>
  </div>
</div>

<footer>© 2025 Macquarie Point Development Corporation</footer>

<!-- Lightbox -->
<div class="lightbox" id="lightbox" role="dialog" aria-modal="true">
  <div class="lb-inner">
    <img id="lbImg" alt="">
    <button class="lb-prev" id="lbPrev" aria-label="Previous image">‹</button>
    <button class="lb-next" id="lbNext" aria-label="Next image">›</button>
    <button class="lb-close" id="lbClose" aria-label="Close">✕</button>
  </div>
</div>

<script>
  const CACHE_BUST = '?v=8'; // bump to force reloads

  // Videos (9)
  const YT_LINKS = [
    "https://youtu.be/Zx76BnLkNlY",
    "https://youtu.be/KcSXlcSaL_8",
    "https://youtu.be/zskCZeWZ-xo",
    "https://youtu.be/nJqy5tg7z_o",
    "https://youtu.be/mJzHTXnSrb8",
    "https://youtu.be/waWApjh_snA",
    "https://youtu.be/84pkAhplxIY",
    "https://youtu.be/NSc6u8vX-cQ",
    "https://youtu.be/zM63SF3_8fI"
  ];

  // Socials (replace # with real URLs)
  const SOCIALS = [
    {label:"Facebook", href:"#"},
    {label:"Instagram", href:"#"},
    {label:"LinkedIn", href:"#"},
    {label:"YouTube", href:"#"}
  ];

  // Plans (groups — fill later)
  const PLANS_GROUPS = [
    { title: "Bowl & Roof", desc: "Key sections and details for main bowl and roof structure.", images: [] },
    { title: "Back-of-House (BOH)", desc: "Service corridors, loading dock, plant areas, and BOH circulation.", images: [] },
    { title: "Public Concourse & Entries", desc: "Entry sequences, concourses, amenities, and egress paths.", images: [] }
  ];

  // Helpers
  const toEmbed = (u)=>{ try{ const url=new URL(u); if(url.hostname==='youtu.be') return `https://www.youtube.com/embed/${url.pathname.slice(1)}`; if(url.hostname.includes('youtube.com')) return `https://www.youtube.com/embed/${url.searchParams.get('v')}`; }catch(e){} return u; };
  function chunk(arr, size){ const out=[]; for(let i=0;i<arr.length;i+=size) out.push(arr.slice(i,i+size)); return out; }

  // ---- Auto-detect Display Boards that actually exist ----
  const BOARD_BASES = ["assets/boards/boards1_","assets/boards/boards2_","assets/boards/boards3_"];
  const BOARD_RANGE = 40; // try 01..40 per set (we'll only keep those that load)
  const EXTENSIONS = ['.jpg','.JPG','.jpeg','.JPEG'];

  function pad2(n){ return n<10 ? '0'+n : ''+n; }

  function probeOne(base, n){
    return new Promise(resolve=>{
      let idx=0;
      function tryNext(){
        if(idx>=EXTENSIONS.length){ resolve(null); return; }
        const url = base + pad2(n) + EXTENSIONS[idx] + CACHE_BUST;
        const img = new Image();
        let done=false;
        const timeout = setTimeout(()=>{ if(!done){ done=true; img.src=''; idx++; tryNext(); } }, 5000);
        img.onload = ()=>{ if(!done){ done=true; clearTimeout(timeout); resolve(url.replace(CACHE_BUST,'')); } };
        img.onerror = ()=>{ if(!done){ done=true; clearTimeout(timeout); idx++; tryNext(); } };
        img.src = url;
      }
      tryNext();
    });
  }

  async function detectBoards(){
    const found=[];
    for(const base of BOARD_BASES){
      for(let n=1;n<=BOARD_RANGE;n++){
        /* eslint-disable no-await-in-loop */
        const url = await probeOne(base, n);
        if(url) found.push(url);
      }
    }
    return found;
  }

  // ---- Build everything after detection ----
  (async function init(){
    const detectedBoards = await detectBoards(); // e.g. 25 items
    buildBook(detectedBoards);
  })();

  function buildBook(DISPLAY_BOARD_FILES){
    // Plans pages
    const PLANS_PAGES = [];
    PLANS_GROUPS.forEach((g, gi)=>{
      const pages = chunk(g.images, 4);
      if(pages.length===0){
        PLANS_PAGES.push({type:'plansGrid', g:gi, p:0, pagesInGroup:1, title:g.title, desc:g.desc, items:[]});
      } else {
        pages.forEach((items, pi)=>{
          PLANS_PAGES.push({type:'plansGrid', g:gi, p:pi, pagesInGroup:pages.length, title:g.title, desc:g.desc, items});
        });
      }
    });

    // Build full book
    const PAGES = [
      { type:"cover", title:"STADIUM DESIGN SHOWCASE", subtitle:"31 Oct – 5 Nov · The Goods Shed, Hobart" },
      ...DISPLAY_BOARD_FILES.map((src,i)=>({type:"image", src, caption:`Display Board ${i+1}`})),
      ...YT_LINKS.map((u,ix)=>({type:"youtube", title:`Video ${ix+1}`, url: toEmbed(u)})),
      ...PLANS_PAGES,
      { type:"links", items:[
        { text:"FAQ: Stadium — Find out more", href:"https://www.macpoint.com/stadium-find-out-more" },
        { text:"Mac Point website", href:"https://www.macpoint.com" }
      ]}
    ];

    // Index helpers
    const coverIndex = 0;
    const boardsStart = 1;
    const videosStart = boardsStart + DISPLAY_BOARD_FILES.length;
    const plansStart  = videosStart + YT_LINKS.length;
    const linksIndex  = plansStart + PLANS_PAGES.length;

    // Render core
    let i = 0;
    const inner = document.getElementById('inner');
    const ind = document.getElementById('ind');

    function scrollTopSmooth(){ try{ window.scrollTo({top:0, behavior:'smooth'}); }catch(e){ window.scrollTo(0,0); } }

    function robustImg(src){
      const img = document.createElement('img');
      img.src = src + CACHE_BUST;
      return img;
    }

    function render(){
      const p = PAGES[i]; inner.className = 'inner'; inner.innerHTML = '';
      if(!p) return;

      if(p.type==='cover'){
        inner.classList.add('cover');
        inner.innerHTML = `
          <div class="kicker">Macquarie Point Development Corporation</div>
          <h1>${p.title}</h1>
          <div class="sub">${p.subtitle}</div>
          <div class="hint" style="margin-top:14px">Use ← / → keys, Next/Prev, or the menu to jump anywhere.</div>
        `;
        ind.textContent = `Page ${i+1} / ${PAGES.length}`;
        return;
      }

      if(p.type==='image'){
        const f = document.createElement('figure');
        const imgEl = robustImg(p.src);
        imgEl.alt = p.caption || 'Display Board';
        const cap = document.createElement('figcaption'); cap.textContent = p.caption || '';
        f.appendChild(imgEl); f.appendChild(cap); inner.appendChild(f);
      }

      if(p.type==='youtube'){
        const iframe = document.createElement('iframe');
        iframe.src = p.url;
        iframe.allow = "accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture";
        inner.appendChild(iframe);
        const caption = document.createElement('div'); caption.className='hint'; caption.textContent = p.title; inner.appendChild(caption);
      }

      if(p.type==='plansGrid'){
        const h = document.createElement('h2'); h.className='plans-head'; h.textContent = p.title;
        const d = document.createElement('p'); d.className='plans-sub'; d.textContent = p.desc||'';
        inner.appendChild(h); inner.appendChild(d);

        const grid = document.createElement('div'); grid.className='plans-grid';
        p.items.forEach((src, idx)=>{
          const wrap = document.createElement('div'); wrap.className='thumb';
          const img = robustImg(src); img.alt = 'Plan preview';
          const label = document.createElement('span'); label.textContent = src.split('/').pop().replace(/\.[^.]+$/,'');
          wrap.appendChild(img); wrap.appendChild(label);
          wrap.onclick = ()=> openLightbox(p.g, p.items, idx);
          grid.appendChild(wrap);
        });
        if(p.items.length===0){
          const empty = document.createElement('div');
          empty.className='min-muted';
          empty.textContent = 'No plan images added yet. Add files to assets/plans/ and list them under this group.';
          inner.appendChild(empty);
        } else {
          inner.appendChild(grid);
        }

        const pager = document.createElement('div'); pager.className='plans-pager';
        const bPrev = document.createElement('button'); bPrev.className='btn-min'; bPrev.textContent='‹ Prev Page';
        const bNext = document.createElement('button'); bNext.className='btn-min'; bNext.textContent='Next Page ›';
        const info = document.createElement('span'); info.className='min-muted';
        info.textContent = `Page ${p.p+1} of ${p.pagesInGroup} in “${p.title}”`;

        const groupFirstAbs = plansStart + PLANS_PAGES.findIndex(pp => pp.g===p.g && pp.p===0);
        bPrev.disabled = (p.p===0);
        bNext.disabled = (p.p===p.pagesInGroup-1);
        bPrev.onclick = ()=>{ if(p.p>0){ i = groupFirstAbs + (p.p-1); render(); scrollTopSmooth(); } };
        bNext.onclick = ()=>{ if(p.p<p.pagesInGroup-1){ i = groupFirstAbs + (p.p+1); render(); scrollTopSmooth(); } };

        pager.appendChild(bPrev); pager.appendChild(info); pager.appendChild(bNext);
        inner.appendChild(pager);
      }

      if(p.type==='links'){
        let html = '<h2>Links & Further Information</h2><ul>';
        (p.items||[]).forEach(it => { html += `<li><a href="${it.href}" target="_blank" rel="noopener">${it.text}</a></li>`; });
        html += '</ul>';
        html += '<h3>MPDC Socials</h3><ul>';
        SOCIALS.forEach(s => { html += `<li><a href="${s.href}" target="_blank" rel="noopener">${s.label}</a></li>`; });
        html += '</ul>';
        inner.innerHTML = html;
      }

      ind.textContent = `Page ${i+1} / ${PAGES.length}`;
      document.getElementById('prev').disabled = (i===0);
      document.getElementById('next').disabled = (i===PAGES.length-1);
    }

    function prev(){ if(i>0){ i--; render(); } }
    function next(){ if(i<PAGES.length-1){ i++; render(); } }
    document.getElementById('prev').onclick = ()=>{ prev(); scrollTopSmooth(); };
    document.getElementById('next').onclick = ()=>{ next(); scrollTopSmooth(); };
    document.addEventListener('keydown', e=>{ if(e.key==='ArrowLeft') prev(); if(e.key==='ArrowRight') next(); });

    // Menus
    const menuBoards = document.getElementById('menuBoards');
    const boardsList = document.getElementById('boardsList');
    const menuVideos = document.getElementById('menuVideos');
    const videosList = document.getElementById('videosList');
    const menuPlans = document.getElementById('menuPlans');
    const plansList = document.getElementById('plansList');
    const jumpLinks = document.getElementById('jumpLinks');

    function closeMenus(e){
      if(!e) return;
      const m1 = e.target.closest('#menuBoards');
      const m2 = e.target.closest('#menuVideos');
      const m3 = e.target.closest('#menuPlans');
      if(!m1) menuBoards.classList.remove('open');
      if(!m2) menuVideos.classList.remove('open');
      if(!m3) menuPlans.classList.remove('open');
    }
    document.addEventListener('click', closeMenus);

    const openMenu = (menuToOpen) => (e)=>{
      e.stopPropagation();
      [menuBoards, menuVideos, menuPlans].forEach(m => { if(m !== menuToOpen) m.classList.remove('open'); });
      menuToOpen.classList.toggle('open');
    };
    menuBoards.querySelector('button').addEventListener('click', openMenu(menuBoards));
    menuVideos.querySelector('button').addEventListener('click', openMenu(menuVideos));
    menuPlans.querySelector('button').addEventListener('click', openMenu(menuPlans));

    // Boards dropdown (auto based on detected files)
    boardsList.innerHTML = '';
    DISPLAY_BOARD_FILES.forEach((src, idx)=>{
      const a = document.createElement('a');
      a.href = '#';
      a.textContent = `Display Board ${idx+1}`;
      a.onclick = (ev)=>{ ev.preventDefault(); i = boardsStart + idx; render(); menuBoards.classList.remove('open'); scrollTopSmooth(); };
      boardsList.appendChild(a);
    });

    // Videos dropdown
    videosList.innerHTML = '';
    YT_LINKS.forEach((u, ix)=>{
      const a = document.createElement('a');
      a.href = '#';
      a.textContent = `Video ${ix+1}`;
      a.onclick = (ev)=>{ ev.preventDefault(); i = videosStart + ix; render(); menuVideos.classList.remove('open'); scrollTopSmooth(); };
      videosList.appendChild(a);
    });

    // Plans dropdown — one entry per group
    plansList.innerHTML = '';
    PLANS_GROUPS.forEach((g, gi)=>{
      const a = document.createElement('a');
      a.href = '#';
      a.textContent = g.title;
      a.onclick = (ev)=>{
        ev.preventDefault();
        let abs = plansStart, offset = 0;
        for (let k = 0; k < PLANS_GROUPS.length; k++){
          const pagesCount = Math.max(1, Math.ceil((PLANS_GROUPS[k].images||[]).length / 4));
          if (k === gi){ abs = plansStart + offset; break; }
          else { offset += pagesCount; }
        }
        i = abs; render(); menuPlans.classList.remove('open'); scrollTopSmooth();
      };
      plansList.appendChild(a);
    });

    // Links menu item
    jumpLinks.addEventListener('click',(e)=>{
      e.preventDefault();
      const plansPageCount = PLANS_GROUPS
        .map(g => Math.max(1, Math.ceil((g.images||[]).length / 4)))
        .reduce((a,b)=>a+b,0);
      i = plansStart + plansPageCount; render(); scrollTopSmooth();
    });

    // Lightbox
    const lb = document.getElementById('lightbox');
    const lbImg = document.getElementById('lbImg');
    const lbPrev = document.getElementById('lbPrev');
    const lbNext = document.getElementById('lbNext');
    const lbClose = document.getElementById('lbClose');

    let lbGroupImages = [];
    let lbIndex = 0;
    function openLightbox(groupIndex, images, startIdx){
      lbGroupImages = images;
      lbIndex = startIdx;
      showLb();
      lb.classList.add('open');
    }
    function showLb(){
      const src = lbGroupImages[lbIndex];
      const img = new Image();
      img.onload = ()=>{ lbImg.src = src + CACHE_BUST; };
      img.src = src + CACHE_BUST;
    }
    lbPrev.onclick = ()=>{ if(lbIndex>0){ lbIndex--; showLb(); } };
    lbNext.onclick = ()=>{ if(lbIndex < lbGroupImages.length-1){ lbIndex++; showLb(); } };
    lbClose.onclick = ()=> lb.classList.remove('open');
    lb.addEventListener('click', (e)=>{ if(e.target===lb) lb.classList.remove('open'); });

    // Home click
    function goHome(){ i = coverIndex; render(); scrollTopSmooth(); }
    document.getElementById('homeBrand').addEventListener('click', goHome);
    document.getElementById('homeTitle').addEventListener('click', goHome);

    // Initial render
    render();

    // Touch swipe
    let startX=null; const paper=document.querySelector('.paper');
    paper.addEventListener('touchstart', e=>{startX=e.changedTouches[0].screenX;}, {passive:true});
    paper.addEventListener('touchend', e=>{
      if(startX==null) return;
      const dx=e.changedTouches[0].screenX-startX;
      if(dx<-40) next();
      if(dx>40) prev();
      startX=null;
    }, {passive:true});
  }
</script>
</body></html>
